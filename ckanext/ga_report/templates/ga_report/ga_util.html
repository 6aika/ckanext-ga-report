<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip=""
  >

<select name="month" py:def="month_selector(current_month, months, day)">
    <option value='' py:attrs="{'selected': 'selected' if not current_month else None}">All months</option>
  <py:for each="i, (val,desc) in enumerate(months)">
    <option value='${val}' py:attrs="{'selected': 'selected' if current_month == val else None}">${desc}<py:if test="i == 0 and day"> (up to ${day})</py:if></option>
  </py:for>
</select>


<table py:def="social_table(items, with_source=False)" class="ga-reports-table table table-condensed table-bordered table-striped">
    <tr>
        <th>Name</th>
        <th py:if="with_source">Source</th>
        <th>Visits</th>
    </tr>
    <py:for each="name, url, source, count in items">
    <tr>
        <td><a href="${url}">${name}</a></td>
        <td py:if="with_source">${source}</td>
        <td class="td-numeric">${count}</td>
    </tr>
    </py:for>
 </table>


<div py:def="rickshaw_graph(items_json,id,mode='line',colorscheme='munin')">
  <div id="chart_container_$id" class="rickshaw_chart_container">
    <div id="y_axis_$id" class="rickshaw_y_axis"></div>
    <div id="chart_$id" class="rickshaw_chart"></div>
    <script type="text/javascript">
      $(function() {
          var items = $items_json;
          if (items.length==0) { return; }
          CKAN.GA_Reports.render_rickshaw('$id', items, '$mode', '$colorscheme');
      });
    </script>
  </div>
</div>


<table py:def="stat_table(items, title='Views')" class="ga-reports-table table table-condensed table-bordered table-striped">
    <tr>
        <th>Name</th>
        <th class="td-numeric">% ${title}</th>
    </tr>
    <py:for each="name, value in items">
    <tr>
        <td>${name}</td>
        <td class="td-numeric">${value}</td>
    </tr>
    </py:for>
 </table>


<div py:def="usage_nav(active_name)">
  <span class="subheading">
    <img src="/images/arrow-down-right.png" />
    <a class="${if_(active_name=='Site-wide','active')}" href="${h.url_for(controller='ckanext.ga_report.controller:GaReport',action='index')}${if_(c.month,'?month='+c.month)}">Site-wide</a>
    <span class="divider">|</span>
    <a class="${if_(active_name=='Publishers','active')}" href="${h.url_for(controller='ckanext.ga_report.controller:GaDatasetReport',action='publishers')}${if_(c.month,'?month='+c.month)}">Publishers</a>
    <span class="divider">|</span>
    <a class="${if_(active_name=='Datasets','active')}" href="${h.url_for(controller='ckanext.ga_report.controller:GaDatasetReport',action='read')}${if_(c.month,'?month='+c.month)}">Datasets</a>
  </span>
</div>


</html>
