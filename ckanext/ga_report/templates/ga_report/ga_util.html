<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip=""
  >

<select name="month" py:def="month_selector(current_month, months, day)">
    <option value='' py:attrs="{'selected': 'selected' if not current_month else None}">All months</option>
  <py:for each="i, (val,desc) in enumerate(months)">
    <option value='${val}' py:attrs="{'selected': 'selected' if current_month == val else None}">${desc}<py:if test="i == 0 and day"> (up to ${day})</py:if></option>
  </py:for>
</select>


<table py:def="social_table(items, with_source=False)" class="table table-condensed table-bordered table-striped">
    <tr>
        <th>Name</th>
        <th py:if="with_source">Source</th>
        <th>Visits</th>
    </tr>
    <py:for each="name, url, source, count in items">
    <tr>
        <td><a href="${url}">${name}</a></td>
        <td py:if="with_source">${source}</td>
        <td>${count}</td>
    </tr>
    </py:for>
 </table>


<div py:def="rickshaw_graph(items_json,id,mode='line')">
  <div id="chart_container_$id" class="rickshaw_chart_container">
    <div id="y_axis_$id" class="rickshaw_y_axis"></div>
    <div id="chart_$id" class="rickshaw_chart"></div>
    <div id="legend_$id" class="rickshaw_legend"></div>
    <script type="text/javascript">
      $(function() {
          var all_series = ${items_json};
          var palette = new Rickshaw.Color.Palette( { scheme: 'munin' } );
          $.each(all_series, function(i, object) {
              object['color'] = palette.color();
          });
          var graph = new Rickshaw.Graph( {
              element: document.querySelector("#chart_$id"),
              renderer: '$mode',
              series: all_series ,
              height: 328
          });
          var x_axis = new Rickshaw.Graph.Axis.Time( { graph: graph } );
          var y_axis = new Rickshaw.Graph.Axis.Y( {
              graph: graph,
              orientation: 'left',
              tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
              element: document.getElementById('y_axis_$id'),
          } );
          var legend = new Rickshaw.Graph.Legend( {
              element: document.querySelector('#legend_$id'),
              graph: graph
          } );
          graph.render();
      });
    </script>
  </div>
</div>


<table py:def="stat_table(items, title='Views')" class="table table-condensed table-bordered table-striped">
    <tr>
        <th>Name</th>
        <th>% ${title}</th>
    </tr>
    <py:for each="name, value in items">
    <tr>
        <td>${name}</td>
        <td>${value}</td>
    </tr>
    </py:for>
 </table>


<div py:def="usage_nav(active_name)" id="minornavigation">
    <div id="minornavigation-bg-left">
    <div id="minornavigation-bg-right">
      <ul class="nav nav-pills">
        <li py:attrs="{'class': 'active' if active_name=='Site-wide' else None}"><a py:attrs="{'class': 'active' if active_name=='Site-wide' else None}"  href="${h.url_for(controller='ckanext.ga_report.controller:GaReport',action='index')}"><img src="/images/icons/page_white.png" height="16px" width="16px" alt="None" class="inline-icon "/> Site-wide</a></li>
        <li py:attrs="{'class': 'active' if active_name=='Publishers' else None}">
                <a py:attrs="{'class': 'active' if active_name=='Publishers' else None}"  href="${h.url_for(controller='ckanext.ga_report.controller:GaDatasetReport',action='publishers')}"><img src="/images/icons/page_white.png" height="16px" width="16px" alt="None" class="inline-icon "/> Publishers</a>
        </li>
        <li py:attrs="{'class': 'active' if active_name=='Datasets' else None}">
                <a py:attrs="{'class': 'active' if active_name=='Datasets' else None}"  href="${h.url_for(controller='ckanext.ga_report.controller:GaDatasetReport',action='read')}"><img src="/images/icons/page_white.png" height="16px" width="16px" alt="None" class="inline-icon "/> Datasets</a>
        </li>
      </ul>
    </div>
    </div>
</div>


</html>
